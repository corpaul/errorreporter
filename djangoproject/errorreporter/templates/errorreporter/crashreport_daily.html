{% load staticfiles %}
<html>
<head>
	<title>Report overview for %s</title>
	<script type="text/javascript">
	function highlight(element) { }
	function unhighlight(element) {}
	</script>
	<style>
	table.crashreport, table.crashreport_aggr {
		width: 1000px;
		margin-bottom: 20px;
	}

	table.crashreport th {
		width: 200px;
	}
	td {
		font-size: 12px;
	}
	</style>
</head>
<body>
<h1>Overview report for {{ date }}</h1>
{% if crashreports %}
	Total # of reports: {{ crashreports|length }}<br>
	Total # of different stacks: {{ crashreports_aggr|length }}
{% else %}
	No crash reports for {{ date }}.
{% endif %}




{% with "errorreporter/flamegraphs/fg_d"|add:date|add:".svg" as flamegraph %}
	<object data="{% static flamegraph %}" type="image/svg+xml" id="version1" width="1000px"></object>
{% endwith %}
<br><br>
{% if crashreports_aggr %}
	{% for c in crashreports_aggr %}
		<table border="1" class="crashreport_aggr">
		<tr>
        <th>Aggregate stacktrace (# of reports: {{ c.cnt }})</th>
        </tr>
        <tr>
        <td>{{ c.stack|linebreaks  }}</td>
       	</tr>
       	<tr>
        <th>Comments</th>
        </tr>
        <tr>
        <td>
       		<ol>
        	{% for r in crashreports %}
        		{% ifequal c.stack r.stack %}
        			<li> {{ r.comments }} (<a href="#{{ r.id }}">#{{ r.id }}</a>)<br>
        		{% endifequal %}
        	{% endfor %}
        	</ol>
        </td>
       	</tr>

       	</table>
	{% endfor %}

{% endif %}

<hr>


{% if crashreports %}
	{% for c in crashreports %}
		<h1><a name="{{ c.id }}">Stack #{{ c.id }}</a></h1>
    	<table border="1" class="crashreport">
		<tr>
        <th>Tribler version</th>
        <td>{{ c.version }}</td>
       	</tr>
       	<tr>
        <th>Sysinfo</th>
        <td>{{ c.sysinfo|linebreaks }}</td>
       	</tr>
       	<tr>
        <th>Comments</th>
        <td>{{ c.comments|linebreaks  }}</td>
       	</tr>
       	<tr>
        <th>Stack</th>
        <td>{{ c.stack|linebreaks  }}</td>
       	</tr>
       	</table>
	{% endfor %}

{% endif %}